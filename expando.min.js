var expando=function(){var a={id:/\#([a-z][a-z\-\_0-9]*)/i,cls:/\.([a-z][a-z\-\_0-9]*)/gi,tag:/^[\s]*([a-z]*)/i,cnt:/\*([0-9]*)/},b={node:function(){this.tag="div",this.classList=[],this.id="",this.modifiers="",this.expansion="",this.children=[],this.count=1},expand:function(a,c){var d=b.treeify(a.split("")),e="";return d.forEach(function(a){a.expand(),e+=b.EM(a,c)}),e},treeify:function(a){for(var c="",d=[],e=0;c=a.shift();)switch("undefined"==typeof d[e]&&(d[e]=new b.node),c){case"{":d[e].children=b.treeify(a);break;case"}":return d;case"+":e++;break;case"[":for(var f=!1,g=!0;a.length>0&&g;)c=a.shift(),f?(d[e].modifiers+=c,f=!1):(d[e].modifiers+="]"!=c&&"\\"!=c?c:"",f="\\"==c,g=!("]"==c));break;default:d[e].expansion+=c}return d},EM:function(a,c,d){if(""===a.expansion.trim()||0===a.children.length)return"";d=d||0;var e=!1;switch(a.tag.toLowerCase()){case"link":case"meta":case"img":case"area":case"source":case"br":case"basefront":case"col":case"hr":case"input":case"keygen":case"embed":case"keygen":case"param":case"source":case"track":case"wbr":e=!0}var f="<"+a.tag;f+=a.id?' id="'+a.id+'"':"",f+=a.modifiers?" "+a.modifiers:"",a.classList.length&&(f+=' class="',a.classList.forEach(function(a,b){f+=(b>0?" ":"")+a.match(/[\.]([a-z\_\-]*)/i)[1]}),f+='"'),f+=(e&&c&&!a.children.length?" /":"")+">",a.children.length&&a.children.forEach(function(a){f+=b.EM(a,c,d+1)}),f+=!e||a.children.length?"</"+a.tag+">":"";for(var g=f,h=2;h<=a.count;h++)f+=g;return f}};return b.node.prototype.expand=function(){var b=this.expansion;this.id=((b.match(a.id)?b.match(a.id)[1]:this.id)||this.id).trim(),this.tag=((b.match(a.tag)?b.match(a.tag)[0]:this.tag)||this.tag).trim(),this.classList=b.match(a.cls)||[];for(var c=this.classList,d=0;d<c.length;d++)c[d]=c[d].trim();if(this.count=b.match(a.cnt)?parseInt(b.match(a.cnt)[1]):1,this.children)for(var d=0;d<this.children.length;d++)this.children[d].expand()},b}();
