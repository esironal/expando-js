(function(){function q(a){for(var c="",b;b=a.shift();)c+=h(b.expand());return c}function k(a){for(var c,b=[],e=0;c=a.shift();)switch(b[e]||(b[e]=new l),b[e].expansion+=c,c.slice(-1)){case "{":r.apply(b[e].children,k(a));break;case "}":return b;case "\\":if(c=a[0])b[e].expansion=b[e].expansion.slice(0,-1),b[e].expansion+=c[0].toString(),a[0]=c.slice(1);break;case "+":e++}return b}function h(a,c,b){var e=!1;if(0===a.expansion.indexOf("="))return(a=/\=(.*)\}/.exec(a.expansion))?a[1]:"";b=b||0;switch(a.a.toLowerCase()){case "link":case "meta":case "img":case "area":case "source":case "br":case "basefront":case "col":case "hr":case "input":case "keygen":case "embed":case "keygen":case "param":case "source":case "track":case "wbr":e=
!0;break;case "":return""}var d="<"+a.a,d=d+(a.id?' id="'+a.id+'"':""),d=d+(a.b?" "+a.b:"");if(a.classList.length){for(var d=d+' class="',f=0;f<a.classList.length;f++)d+=(0<f?" ":"")+a.classList[f].slice(1);d+='"'}d+=(e&&c&&!a.children.length?" /":"")+">";if(a.children.length)for(f=0;f<a.children.length;f++)d+=h(a.children[f],c,b+1);d+=e&&0===a.children.length?"":"</"+a.a+">";if(1<a.count){c=d;a=a.count;for(b="";0<a;)1==a%2&&(b+=c),c+=c,a>>=1;a=b}else a=d;return a}function l(){this.a="div";this.classList=
[];this.expansion=this.b=this.id="";this.children=[];this.count=1}var s=/([^\{\}\+\\]*)([\\\+\{\}])?/gm,m=/\#([a-z][a-z\-\_0-9]*)/i,t=/\.([a-z][a-z\-\_0-9]*)/gi,n=/^[\s]*([a-z]*)/i,p=/\*([0-9]*)/,u=String.prototype.replace,r=Array.prototype.push;l.prototype.expand=function(){var a=this.expansion;this.id=((a.match(m)?a.match(m)[1]:this.id)||this.id).trim();this.a=((a.match(n)?a.match(n)[0]:this.a)||this.a).trim();this.classList=a.match(t)||[];this.count=a.match(p)?parseInt(a.match(p)[1]):1;if(this.children.length)for(a=
0;a<this.children.length;a++)this.children[a].expand();return this};return function(a,c){if(c){var b;a=u.call(a,/\%([a-z][a-z0-9\_\.]*)/gmi,function(a,d){for(var f=d.split(".").reverse(),g=c;b=f.pop();)g=g[b];return g})}return q(k(a.match(s)))||"<div></div>"}})();